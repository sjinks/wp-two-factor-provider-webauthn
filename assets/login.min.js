!function(e){function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t.apply(this,arguments)}var r=e.__("WebAuthn is not supported by the browser.","two-factor-provider-webauthn"),n=e.__("Unable to get a public key credential.","two-factor-provider-webauthn"),o=e.__("The request is not allowed.","two-factor-provider-webauthn"),a=e.__("The operation is insecure.","two-factor-provider-webauthn"),i=e.__("The operation is not supported.","two-factor-provider-webauthn"),d=e.__("The operation was canceled.","two-factor-provider-webauthn"),u=e.__("You cannot use this key to log in.","two-factor-provider-webauthn"),c=e.__("This key is already registered.","two-factor-provider-webauthn");function s(e){return window.btoa(String.fromCharCode.apply(String,e))}function l(e){return window.atob(e.replace(/-/g,"+").replace(/_/g,"/")+"=".repeat(3-(3+e.length)%4))}function w(e){return Uint8Array.from(e,(function(e){return e.charCodeAt(0)}))}function h(e){var t=document.getElementById("login_error");t&&t.parentNode&&t.parentNode.removeChild(t);var r=document.getElementById("loginform");r&&r.insertAdjacentHTML("beforebegin",'<div id="login_error" role="alert"><p>'+e+"</p></div>")}function p(){var e=document.getElementById("loginform"),r=function(e){var r;return t({},e,{challenge:w(l(e.challenge)),allowCredentials:null===(r=e.allowCredentials)||void 0===r?void 0:r.map((function(e){return t({},e,{id:w(l(e.id))})}))})}(tfa_webauthn.options);navigator.credentials.get({publicKey:r}).then((function(t){if(!t)throw new Error(n);var r,o;document.getElementById("webauthn_response").value=JSON.stringify((o=(r=t).response,{id:r.id,type:r.type,rawId:s(new Uint8Array(r.rawId)),clientExtensionResults:r.getClientExtensionResults(),response:{attestationObject:"attestationObject"in o?s(new Uint8Array(o.attestationObject)):void 0,authenticatorData:"authenticatorData"in o?s(new Uint8Array(o.authenticatorData)):void 0,signature:"signature"in o?s(new Uint8Array(o.signature)):void 0,userHandle:"userHandle"in o&&o.userHandle?s(new Uint8Array(o.userHandle)):void 0,clientDataJSON:s(new Uint8Array(r.response.clientDataJSON))}})),e.submit()})).catch((function(e){h(e instanceof DOMException?function(e,t){switch(e.name){case"NotAllowedError":return o;case"SecurityError":return a;case"NotSupportedError":return i;case"AbortError":return d;case"InvalidStateError":return t?u:c;default:return e.message}}(e,!0):e.message),document.getElementById("webauthn-retry").removeAttribute("hidden")}))}e.__("This key is already registered.","two-factor-provider-webauthn"),e.__("Fetching registration information…","two-factor-provider-webauthn"),e.__("Generating credentials…","two-factor-provider-webauthn"),e.__("Registering credentials…","two-factor-provider-webauthn"),e.__("Unable to create public key credentials","two-factor-provider-webauthn"),e.__("The key has been registered.","two-factor-provider-webauthn"),e.__("Sending request…","two-factor-provider-webauthn"),e.__("The key has been revoked.","two-factor-provider-webauthn"),e.__("The key has been renamed.","two-factor-provider-webauthn");var b=function(){document.querySelector("#webauthn-retry .button").addEventListener("click",(function(e){document.getElementById("webauthn-retry").setAttribute("hidden","hidden"),p()})),"credentials"in navigator?navigator.webdriver?document.getElementById("webauthn-retry").removeAttribute("hidden"):p():h(r)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",b):b()}(wp.i18n);
